"use strict";(self["webpackChunkvue02"]=self["webpackChunkvue02"]||[]).push([[553],{4553:function(a,t,e){e.r(t),e.d(t,{default:function(){return D}});var d=e(3396),l=e(7139);const s=a=>((0,d.dD)("data-v-8da6188e"),a=a(),(0,d.Cn)(),a),o=(0,d.Uk)("获取目录下所有文件列表"),i=(0,d.Uk)("开始"),n=s((()=>(0,d._)("div",null,null,-1))),r={class:"demo-image__placeholder"},m={class:"block"},p=s((()=>(0,d._)("span",{class:"demonstration"},"封面图",-1))),u=s((()=>(0,d._)("div",{class:"image-slot"},[(0,d.Uk)("Loading"),(0,d._)("span",{class:"dot"},"...")],-1))),c={class:"block"},f=s((()=>(0,d._)("span",{class:"demonstration"},"背景图",-1))),h=s((()=>(0,d._)("div",{class:"image-slot"},[(0,d.Uk)("Loading"),(0,d._)("span",{class:"dot"},"...")],-1))),w=(0,d.Uk)("搜索"),_={style:{display:"flex","align-items":"center"}};function g(a,t,e,s,g,b){const y=(0,d.up)("el-input"),v=(0,d.up)("el-button"),k=(0,d.up)("el-table-column"),D=(0,d.up)("el-table"),W=(0,d.up)("el-col"),V=(0,d.up)("el-form-item"),K=(0,d.up)("el-form"),x=(0,d.up)("el-image"),j=(0,d.up)("el-row"),q=(0,d.up)("el-dialog");return(0,d.wg)(),(0,d.iD)(d.HY,null,[(0,d._)("div",null,[(0,d.Wm)(y,{modelValue:a.path,"onUpdate:modelValue":t[0]||(t[0]=t=>a.path=t),placeholder:"请输入目录"},null,8,["modelValue"]),(0,d.Wm)(v,{onClick:s.search_file_list,loading:a.load},{default:(0,d.w5)((()=>[o])),_:1},8,["onClick","loading"]),(0,d.Wm)(v,{onClick:s.start,loading:a.load},{default:(0,d.w5)((()=>[i])),_:1},8,["onClick","loading"])]),(0,d.Wm)(j,null,{default:(0,d.w5)((()=>[(0,d.Wm)(W,{span:12},{default:(0,d.w5)((()=>[(0,d._)("div",null,[(0,d.Wm)(D,{data:a.tableData,border:"",style:{width:"100%"}},{default:(0,d.w5)((()=>[(0,d.Wm)(k,{prop:"name",label:"文件名"})])),_:1},8,["data"])])])),_:1}),(0,d.Wm)(W,{span:12},{default:(0,d.w5)((()=>[n,(0,d.Wm)(K,{model:a.form,"label-width":"120px"},{default:(0,d.w5)((()=>[(0,d.Wm)(V,{label:"当前状态"},{default:(0,d.w5)((()=>[(0,d._)("div",null,(0,l.zw)(a.form.status),1)])),_:1}),(0,d.Wm)(V,{label:"文件名"},{default:(0,d.w5)((()=>[(0,d.Wm)(y,{modelValue:a.form.name,"onUpdate:modelValue":t[1]||(t[1]=t=>a.form.name=t)},null,8,["modelValue"])])),_:1}),(0,d.Wm)(V,{label:"新建目录"},{default:(0,d.w5)((()=>[(0,d.Wm)(y,{modelValue:a.form.dir,"onUpdate:modelValue":t[2]||(t[2]=t=>a.form.dir=t)},null,8,["modelValue"])])),_:1}),(0,d.Wm)(V,{label:"简介"},{default:(0,d.w5)((()=>[(0,d.Wm)(y,{rows:6,modelValue:a.form.desc,"onUpdate:modelValue":t[3]||(t[3]=t=>a.form.desc=t),type:"textarea"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"]),(0,d._)("div",r,[(0,d._)("div",m,[p,(0,d.Wm)(x,{fit:"scale-down",src:a.poster},{placeholder:(0,d.w5)((()=>[u])),_:1},8,["src"])]),(0,d._)("div",c,[f,(0,d.Wm)(x,{fit:"contain",src:a.backdrop},{placeholder:(0,d.w5)((()=>[h])),_:1},8,["src"])])])])),_:1})])),_:1}),(0,d._)("div",null,[(0,d.Wm)(q,{modelValue:a.centerDialogVisible,"onUpdate:modelValue":t[5]||(t[5]=t=>a.centerDialogVisible=t),title:"654",width:"80%",center:""},{title:(0,d.w5)((()=>[(0,d._)("span",null,(0,l.zw)(a.title),1)])),footer:(0,d.w5)((()=>[])),default:(0,d.w5)((()=>[(0,d._)("div",null,[(0,d.Wm)(K,{"label-width":"120px"},{default:(0,d.w5)((()=>[(0,d.Wm)(V,{label:"关键词"},{default:(0,d.w5)((()=>[(0,d.Wm)(y,{modelValue:a.keyword,"onUpdate:modelValue":t[4]||(t[4]=t=>a.keyword=t)},null,8,["modelValue"])])),_:1}),(0,d.Wm)(V,null,{default:(0,d.w5)((()=>[(0,d.Wm)(v,{type:"primary",onClick:s.onSubmit},{default:(0,d.w5)((()=>[w])),_:1},8,["onClick"])])),_:1})])),_:1}),(0,d.Wm)(D,{data:a.fileData,border:"",style:{width:"100%"},onRowDblclick:s.dblclick},{default:(0,d.w5)((()=>[(0,d.Wm)(k,{label:"封面",width:"150"},{default:(0,d.w5)((a=>[(0,d._)("div",_,[(0,d.Wm)(x,{src:a.row.image,lazy:""},null,8,["src"])])])),_:1}),(0,d.Wm)(k,{prop:"name",label:"文件名",width:"200"}),(0,d.Wm)(k,{prop:"overview",label:"简介"})])),_:1},8,["data","onRowDblclick"])])])),_:1},8,["modelValue"])])],64)}var b=e(4870),y={setup(){const{proxy:a}=(0,d.FN)(),t=(0,b.qj)({poster:"",backdrop:"",src:"https://cube.elemecdn.com/6/94/4d3ea53c084bad6931a56d5158a48jpeg.jpeg",path:"Z:\\下载区\\[桜都字幕组]2018年年度合集",input:!1,centerDialogVisible:!1,title:"987",keyword:"",thisKey:0,load:!1,form:{status:"未开始……",name:"",dir:"",desc:""},tableData:[{name:"Tom",path:"No. 189, Grove St, Los Angeles"}],fileData:[{name:""}],download:{name:"",dir:"",info:"",poster:"",fanart:""}}),e=async(e,d,l)=>{t.centerDialogVisible=!1;let s=t.tableData[t.thisKey],o=e.id,u=t.tableData.length;t.form.status="["+(t.thisKey+1)+"]["+u+"]开始搜索["+o+"]影视信息";const c=await new a.$request("http://127.0.0.1:8787/index/find_tv",{id:o}).post();t.form.name=t.title,t.form.dir=e.name,t.form.desc=e.overview,200==c.data.code&&(t.form.status="["+(t.thisKey+1)+"]["+u+"]开始创建["+c.data.data.name+"]目录",p(c.data.data.name,t.path),t.form.status="["+(t.thisKey+1)+"]["+u+"]开始添加指定ID["+c.data.data.id+"]到nfo文件",m(c.data.data.id,c.data.data.name,t.path),null!=c.data.data.poster_path&&(t.form.status="["+(t.thisKey+1)+"]["+u+"]开始下载封面图",r(c.data.data.id,"https://image.tmdb.org/t/p/original"+c.data.data.poster_path,c.data.data.name,t.path,"poster.jpg")),null!=c.data.data.backdrop_path&&(t.form.status="["+(t.thisKey+1)+"]["+u+"]开始下载背景图",r(c.data.data.id,"https://image.tmdb.org/t/p/original"+c.data.data.backdrop_path,c.data.data.name,t.path,"fanart.jpg")),t.form.status="["+(t.thisKey+1)+"]["+u+"]开始移动文件到输出目录",n(c.data.data.name,s.path_name,t.path,s.name),t.form.status="延迟3S",setTimeout((function(){i(t.thisKey+1,t.tableData.length),t.form.status="延迟3S结束"}),3e3))},l=async()=>{let e=t.tableData[t.thisKey];t.centerDialogVisible=!1;const d=await new a.$request("http://127.0.0.1:8787/index/search_file",{name:t.keyword}).post();if(200==d.data.code){for(let a of d.data.data.results)a.image="https://image.tmdb.org/t/p/original"+a.poster_path;let l=t.tableData.length;if(t.fileData=d.data.data.results,t.form.status="["+(t.thisKey+1)+"]["+l+"]搜索到["+d.data.data.total_results+"]条结果",1==d.data.data.total_results){t.form.status="["+(t.thisKey+1)+"]["+l+"]开始搜索["+d.data.data.results[0]["id"]+"]影视信息";const s=await new a.$request("http://127.0.0.1:8787/index/find_tv",{id:d.data.data.results[0]["id"]}).post();t.form.name=t.title,t.form.dir=d.data.data.results[0]["name"],t.form.desc=d.data.data.results[0]["overview"],200==s.data.code&&(t.form.status="["+(t.thisKey+1)+"]["+l+"]开始创建["+s.data.data.name+"]目录",p(s.data.data.name,t.path),t.form.status="["+(t.thisKey+1)+"]["+l+"]开始添加指定ID["+s.data.data.id+"]到nfo文件",m(s.data.data.id,s.data.data.name,t.path),null!=s.data.data.poster_path&&(t.form.status="["+(t.thisKey+1)+"]["+l+"]开始下载封面",await r(s.data.data.id,"https://image.tmdb.org/t/p/original"+s.data.data.poster_path,s.data.data.name,t.path,"poster.jpg")),null!=s.data.data.backdrop_path&&(t.form.status="["+(t.thisKey+1)+"]["+l+"]开始下载背景图",await r(s.data.data.id,"https://image.tmdb.org/t/p/original"+s.data.data.backdrop_path,s.data.data.name,t.path,"fanart.jpg")),t.form.status="["+(t.thisKey+1)+"]["+l+"]开始移动文件到输出目录",await n(s.data.data.name,e.path_name,t.path,e.name),t.form.status="延迟3S",setTimeout((function(){i(t.thisKey+1,t.tableData.length),t.form.status="延迟3S结束"}),3e3))}else t.centerDialogVisible=!0}},s=async()=>{const e=await new a.$request("http://127.0.0.1:8787/index/get_file_list",{path:t.path}).post();t.tableData=e.data},o=()=>{t.load=!0,i(0,t.tableData.length)},i=async(e,d)=>{if(e>=d)return t.load=!1,!1;t.form.status="["+(e+1)+"]["+d+"]当前正在搜索文件"+t.tableData[e]["name"],t.form.name="搜索中……",t.form.dir="搜索中……",t.form.desc="搜索中……",t.poster="https://cube.elemecdn.com/6/94/4d3ea53c084bad6931a56d5158a48jpeg.jpeg",t.backdrop="https://cube.elemecdn.com/6/94/4d3ea53c084bad6931a56d5158a48jpeg.jpeg",console.log("["+(e+1)+"]["+d+"]当前正在搜索文件"+t.tableData[e]["name"]),t.thisKey=e,t.title=t.tableData[e]["name"];let l=t.tableData[e],s=l.name.replace(/\[.+\]/,""),o=s.split(" ").filter((function(a){return a&&a.trim()}));t.keyword=o[0];const u=await new a.$request("http://127.0.0.1:8787/index/search_file",{name:o[0]}).post();if(200==u.data.code){for(let a of u.data.data.results)a.image="https://image.tmdb.org/t/p/original"+a.poster_path;if(t.form.status="["+(e+1)+"]["+d+"]搜索到["+u.data.data.total_results+"]条结果",t.fileData=u.data.data.results,1==u.data.data.total_results){t.form.status="["+(e+1)+"]["+d+"]开始搜索["+u.data.data.results[0]["id"]+"]影视信息";const s=await new a.$request("http://127.0.0.1:8787/index/find_tv",{id:u.data.data.results[0]["id"]}).post();t.form.name=t.title,t.form.dir=u.data.data.results[0]["name"],t.form.desc=u.data.data.results[0]["overview"],200==s.data.code&&(t.form.status="["+(e+1)+"]["+d+"]开始创建["+s.data.data.name+"]目录",await p(s.data.data.name,t.path),t.form.status="["+(e+1)+"]["+d+"]开始添加指定ID["+s.data.data.id+"]到nfo文件",await m(s.data.data.id,s.data.data.name,t.path),null!=s.data.data.poster_path&&(t.form.status="["+(e+1)+"]["+d+"]开始下载封面",await r(s.data.data.id,"https://image.tmdb.org/t/p/original"+s.data.data.poster_path,s.data.data.name,t.path,"poster.jpg")),null!=s.data.data.backdrop_path&&(t.form.status="["+(e+1)+"]["+d+"]开始下载背景图",await r(s.data.data.id,"https://image.tmdb.org/t/p/original"+s.data.data.backdrop_path,s.data.data.name,t.path,"fanart.jpg")),t.form.status="["+(e+1)+"]["+d+"]开始移动文件到输出目录",await n(s.data.data.name,l.path_name,t.path,l.name),t.form.status="延迟3S",setTimeout((function(){i(e+1,t.tableData.length),t.form.status="延迟3S结束"}),3e3))}else t.centerDialogVisible=!0}},n=async(t,e,d,l)=>{await new a.$request("http://127.0.0.1:8787/index/move_file",{name:t,path:e,save_path:d,rel_name:l}).post()},r=async(e,d,l,s,o)=>{const i=await new a.$request("http://127.0.0.1:8787/index/download_image",{id:e,url:d,name:l,path:s,save_name:o}).post();200==i.data.code&&("poster.jpg"==o?(t.poster=i.data.image,t.download.poster='<div>封面图</div><img width="150" src="'+i.data.image+'">'):"fanart.jpg"==o&&(t.backdrop=i.data.image,t.download.fanart='<div>背景图</div><img width="300" src="'+i.data.image+'">'))},m=async(t,e,d)=>{await new a.$request("http://127.0.0.1:8787/index/insert_tv_id",{id:t,name:e,path:d}).post()},p=async(t,e)=>{await new a.$request("http://127.0.0.1:8787/index/mkdir",{name:t,path:e}).post()};return{...(0,b.BK)(t),start:o,onSubmit:l,dblclick:e,search_file_list:s}},name:"index"},v=e(89);const k=(0,v.Z)(y,[["render",g],["__scopeId","data-v-8da6188e"]]);var D=k}}]);
//# sourceMappingURL=553.f42a0832.js.map